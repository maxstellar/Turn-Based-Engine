[gd_scene format=3 uid="uid://cmma68wx7pjxk"]

[ext_resource type="Texture2D" uid="uid://hc7yv8nhxiav" path="res://images/max-shooting-star-favicon.png" id="1_igant"]
[ext_resource type="Script" uid="uid://c0riph24nw8id" path="res://player.gd" id="1_iu5wp"]
[ext_resource type="Texture2D" uid="uid://duhd6bbqr7b5j" path="res://images/character_maleAdventurer_side.png" id="2_1mvxi"]
[ext_resource type="Script" uid="uid://daa7uar41h3ec" path="res://turn_manager.gd" id="2_rw42p"]
[ext_resource type="PackedScene" uid="uid://b5hgv1rg5d622" path="res://health_bar.tscn" id="3_pbb3x"]
[ext_resource type="Script" uid="uid://cxr1uafxoyits" path="res://enemy.gd" id="3_w13k5"]

[sub_resource type="BoxShape3D" id="BoxShape3D_rw42p"]
size = Vector3(60, 2, 60)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_iu5wp"]
albedo_color = Color(0.09, 0.09, 0.09, 1)

[sub_resource type="BoxMesh" id="BoxMesh_w13k5"]
material = SubResource("StandardMaterial3D_iu5wp")
size = Vector3(60, 2, 60)

[sub_resource type="Environment" id="Environment_igant"]
background_mode = 2

[sub_resource type="ViewportTexture" id="ViewportTexture_1mvxi"]
viewport_path = NodePath("Player2/SubViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_pbb3x"]
viewport_path = NodePath("Enemy/SubViewport")

[node name="Battle" type="Node3D" unique_id=383191968]

[node name="Ground" type="StaticBody3D" parent="." unique_id=2009845223]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Ground" unique_id=1089847039]
shape = SubResource("BoxShape3D_rw42p")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Ground" unique_id=227555885]
mesh = SubResource("BoxMesh_w13k5")

[node name="Light" type="DirectionalLight3D" parent="." unique_id=1336609458]
transform = Transform3D(1, 0, 0, 0, 0.7071067, 0.7071068, 0, -0.7071068, 0.7071067, 12.167614, 13, 17.54323)
shadow_enabled = true

[node name="Sky" type="WorldEnvironment" parent="." unique_id=449381734]
environment = SubResource("Environment_igant")

[node name="Camera" type="Camera3D" parent="." unique_id=617503816]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.137501, 1.296743, 4.2892594)

[node name="Player" type="Node3D" parent="." unique_id=497562079 node_paths=PackedStringArray("health_bar")]
script = ExtResource("1_iu5wp")
health_bar = NodePath("SubViewport/PlayerHealthBar")
health = 100

[node name="PlayerSprite" type="Sprite3D" parent="Player" unique_id=1379187437]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.049521, 0)
pixel_size = 0.008
shaded = true
alpha_cut = 2
texture_filter = 0
texture = ExtResource("2_1mvxi")

[node name="SubViewport" type="SubViewport" parent="Player" unique_id=757638501]
transparent_bg = true

[node name="PlayerHealthBar" parent="Player/SubViewport" unique_id=1814424513 instance=ExtResource("3_pbb3x")]
value = 100.0

[node name="HealthBarSprite" type="Sprite3D" parent="Player" unique_id=608706190]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.9194355, 0)
billboard = 1
texture_filter = 0
texture = SubResource("ViewportTexture_1mvxi")

[node name="Enemy" type="Node3D" parent="." unique_id=221595117 node_paths=PackedStringArray("health_bar")]
script = ExtResource("3_w13k5")
health_bar = NodePath("SubViewport/EnemyHealthBar")
health = 100

[node name="EnemySprite" type="Sprite3D" parent="Enemy" unique_id=63957800]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.4314075, 0.578, 0)
pixel_size = 0.003
shaded = true
alpha_cut = 2
texture_filter = 0
texture = ExtResource("1_igant")

[node name="SubViewport" type="SubViewport" parent="Enemy" unique_id=1889240331]
transparent_bg = true

[node name="EnemyHealthBar" parent="Enemy/SubViewport" unique_id=1407239397 instance=ExtResource("3_pbb3x")]
value = 100.0

[node name="HealthBarSprite" type="Sprite3D" parent="Enemy" unique_id=1310744835]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.436987, 1.6642771, 0)
billboard = 1
texture = SubResource("ViewportTexture_pbb3x")

[node name="Turn Manager" type="Node" parent="." unique_id=1288002591 node_paths=PackedStringArray("camera", "attack_button", "defend_button", "player", "enemy", "enemy_cd")]
script = ExtResource("2_rw42p")
camera = NodePath("../Camera")
attack_button = NodePath("../UI/AttackButton")
defend_button = NodePath("../UI/SkillButton")
player = NodePath("../Player")
enemy = NodePath("../Enemy")
enemy_cd = NodePath("../EnemyCD")

[node name="UI" type="CanvasLayer" parent="." unique_id=1803909681]

[node name="AttackButton" type="Button" parent="UI" unique_id=1436647482]
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_left = 10.0
offset_top = -78.0
offset_right = 165.0
offset_bottom = -10.0
grow_vertical = 0
text = "Attack"

[node name="SkillButton" type="Button" parent="UI" unique_id=1294590681]
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_left = 175.0
offset_top = -78.0
offset_right = 330.0
offset_bottom = -10.0
grow_vertical = 0
text = "Skill"

[node name="EnemyCD" type="Timer" parent="." unique_id=791373146]
one_shot = true

[connection signal="pressed" from="UI/AttackButton" to="Turn Manager" method="_on_attack_button_pressed"]
[connection signal="timeout" from="EnemyCD" to="Turn Manager" method="_on_enemy_cd_timeout"]
